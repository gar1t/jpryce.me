!function(t,e,i){"use strict";var o=t(e),n=e.Modernizr;n.addTest("csstransformspreserve3d",function(){var t,i=n.prefixed("transformStyle"),o="preserve-3d";return i?(i=i.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-"),n.testStyles("#modernizr{"+i+":"+o+";}",function(o){t=e.getComputedStyle?getComputedStyle(o,null).getPropertyValue(i):""}),t===o):!1});var a,s,r=t.event;a=r.special.debouncedresize={setup:function(){t(this).on("resize",a.handler)},teardown:function(){t(this).off("resize",a.handler)},handler:function(t,e){var i=this,o=arguments,n=function(){t.type="debouncedresize",r.dispatch.apply(i,o)};s&&clearTimeout(s),e?n():s=setTimeout(n,a.threshold)},threshold:150},t.BookBlock=function(e,i){this.$el=t(i),this._init(e)},t.BookBlock.defaults={orientation:"vertical",direction:"ltr",speed:1e3,easing:"ease-in-out",shadows:!0,shadowSides:.2,shadowFlip:.1,circular:!1,nextEl:"",prevEl:"",autoplay:!1,interval:3e3,onEndFlip:function(){return!1},onBeforeFlip:function(){return!1}},t.BookBlock.prototype={_init:function(e){this.options=t.extend(!0,{},t.BookBlock.defaults,e),this.$el.addClass("bb-"+this.options.orientation),this.$items=this.$el.children(".bb-item").hide(),this.itemsCount=this.$items.length,this.current=0,this.previous=-1,this.$current=this.$items.eq(this.current).show(),this.elWidth=this.$el.width();var i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.transEndEventName=i[n.prefixed("transition")]+".bookblock",this.support=n.csstransitions&&n.csstransforms3d&&n.csstransformspreserve3d,this._initEvents(),this.options.autoplay&&(this.options.circular=!0,this._startSlideshow())},_initEvents:function(){var e=this;""!==this.options.nextEl&&t(this.options.nextEl).on("click.bookblock touchstart.bookblock",function(){return e._action("next"),!1}),""!==this.options.prevEl&&t(this.options.prevEl).on("click.bookblock touchstart.bookblock",function(){return e._action("prev"),!1}),o.on("debouncedresize",function(){e.elWidth=e.$el.width()})},_action:function(t,e){this._stopSlideshow(),this._navigate(t,e)},_navigate:function(t,e){return this.isAnimating?!1:(this.options.onBeforeFlip(this.current),this.isAnimating=!0,this.$current=this.$items.eq(this.current),e!==i?this.current=e:"next"===t&&"ltr"===this.options.direction||"prev"===t&&"rtl"===this.options.direction?this.options.circular||this.current!==this.itemsCount-1?(this.previous=this.current,this.current=this.current<this.itemsCount-1?this.current+1:0):this.end=!0:("prev"===t&&"ltr"===this.options.direction||"next"===t&&"rtl"===this.options.direction)&&(this.options.circular||0!==this.current?(this.previous=this.current,this.current=this.current>0?this.current-1:this.itemsCount-1):this.end=!0),this.$nextItem=!this.options.circular&&this.end?this.$current:this.$items.eq(this.current),this.support?this._layout(t):this._layoutNoSupport(t),void 0)},_layoutNoSupport:function(t){this.$items.hide(),this.$nextItem.show(),this.end=!1,this.isAnimating=!1;var e="next"===t&&this.current===this.itemsCount-1||"prev"===t&&0===this.current;this.options.onEndFlip(this.previous,this.current,e)},_layout:function(e){var i=this,o=this._addSide("left",e),n=this._addSide("middle",e),a=this._addSide("right",e),s=o.find("div.bb-overlay"),r=n.find("div.bb-flipoverlay:first"),l=n.find("div.bb-flipoverlay:last"),d=a.find("div.bb-overlay"),c=this.end?400:this.options.speed;if(this.$items.hide(),this.$el.prepend(o,n,a),n.css({transitionDuration:c+"ms",transitionTimingFunction:this.options.easing}).on(this.transEndEventName,function(o){if(t(o.target).hasClass("bb-page")){i.$el.children(".bb-page").remove(),i.$nextItem.show(),i.end=!1,i.isAnimating=!1;var n="next"===e&&i.current===i.itemsCount-1||"prev"===e&&0===i.current;i.options.onEndFlip(i.previous,i.current,n)}}),"prev"===e&&n.addClass("bb-flip-initial"),this.options.shadows&&!this.end){var u="next"===e?{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms"}:{transition:"opacity "+this.options.speed/2+"ms "+"linear",opacity:this.options.shadowSides},h="next"===e?{transition:"opacity "+this.options.speed/2+"ms "+"linear"}:{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms",opacity:this.options.shadowFlip},f="next"===e?{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms",opacity:this.options.shadowFlip}:{transition:"opacity "+this.options.speed/2+"ms "+"linear"},p="next"===e?{transition:"opacity "+this.options.speed/2+"ms "+"linear",opacity:this.options.shadowSides}:{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms"};r.css(h),l.css(f),s.css(u),d.css(p)}setTimeout(function(){n.addClass(i.end?"bb-flip-"+e+"-end":"bb-flip-"+e),i.options.shadows&&!i.end&&(r.css({opacity:"next"===e?i.options.shadowFlip:0}),l.css({opacity:"next"===e?0:i.options.shadowFlip}),s.css({opacity:"next"===e?i.options.shadowSides:0}),d.css({opacity:"next"===e?0:i.options.shadowSides}))},25)},_addSide:function(e,i){var o;switch(e){case"left":o=t('<div class="bb-page"><div class="bb-back"><div class="bb-outer"><div class="bb-content"><div class="bb-inner">'+("next"===i?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",102);break;case"middle":o=t('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content"><div class="bb-inner">'+("next"===i?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-flipoverlay"></div></div></div><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+("next"===i?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-flipoverlay"></div></div></div></div>').css("z-index",103);break;case"right":o=t('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content"><div class="bb-inner">'+("next"===i?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",101)}return o},_startSlideshow:function(){var t=this;this.slideshow=setTimeout(function(){t._navigate("next"),t.options.autoplay&&t._startSlideshow()},this.options.interval)},_stopSlideshow:function(){this.options.autoplay&&(clearTimeout(this.slideshow),this.options.autoplay=!1)},next:function(){this._action("ltr"===this.options.direction?"next":"prev")},prev:function(){this._action("ltr"===this.options.direction?"prev":"next")},jump:function(t){if(t-=1,t===this.current||t>=this.itemsCount||0>t)return!1;var e;e="ltr"===this.options.direction?t>this.current?"next":"prev":t>this.current?"prev":"next",this._action(e,t)},last:function(){this.jump(this.itemsCount)},first:function(){this.jump(1)},isActive:function(){return this.isAnimating},update:function(){var t=this.$items.eq(this.current);this.$items=this.$el.children(".bb-item"),this.itemsCount=this.$items.length,this.current=t.index()},destroy:function(){this.options.autoplay&&this._stopSlideshow(),this.$el.removeClass("bb-"+this.options.orientation),this.$items.show(),""!==this.options.nextEl&&t(this.options.nextEl).off(".bookblock"),""!==this.options.prevEl&&t(this.options.prevEl).off(".bookblock"),o.off("debouncedresize")}};var l=function(t){e.console&&e.console.error(t)};t.fn.bookblock=function(e){if("string"==typeof e){var i=Array.prototype.slice.call(arguments,1);this.each(function(){var o=t.data(this,"bookblock");return o?t.isFunction(o[e])&&"_"!==e.charAt(0)?(o[e].apply(o,i),void 0):(l("no such method '"+e+"' for bookblock instance"),void 0):(l("cannot call methods on bookblock prior to initialization; attempted to call method '"+e+"'"),void 0)})}else this.each(function(){var i=t.data(this,"bookblock");i?i._init():i=t.data(this,"bookblock",new t.BookBlock(e,this))});return this}}(jQuery,window);